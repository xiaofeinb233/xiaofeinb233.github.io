(function(t){function e(e){for(var r,n,o=e[0],l=e[1],c=e[2],u=0,p=[];u<o.length;u++)n=o[u],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&p.push(s[n][0]),s[n]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);h&&h(e);while(p.length)p.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],r=!0,n=1;n<a.length;n++){var l=a[n];0!==s[l]&&(r=!1)}r&&(i.splice(e--,1),t=o(o.s=a[0]))}return t}var r={},s={app:0},i=[];function n(t){return o.p+"js/"+({about:"about"}[t]||t)+"."+{about:"4789e891"}[t]+".js"}function o(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(t){var e=[],a=s[t];if(0!==a)if(a)e.push(a[2]);else{var r=new Promise((function(e,r){a=s[t]=[e,r]}));e.push(a[2]=r);var i,l=document.createElement("script");l.charset="utf-8",l.timeout=120,o.nc&&l.setAttribute("nonce",o.nc),l.src=n(t);var c=new Error;i=function(e){l.onerror=l.onload=null,clearTimeout(u);var a=s[t];if(0!==a){if(a){var r=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",c.name="ChunkLoadError",c.type=r,c.request=i,a[1](c)}s[t]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:l})}),12e4);l.onerror=l.onload=i,document.head.appendChild(l)}return Promise.all(e)},o.m=t,o.c=r,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(a,r,function(e){return t[e]}.bind(null,r));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=e,l=l.slice();for(var u=0;u<l.length;u++)e(l[u]);var h=c;i.push([1,"chunk-vendors"]),a()})({0:function(t,e){},"05a4":function(t,e,a){},"05b7":function(t,e,a){},"099e":function(t,e,a){"use strict";a("dc2d")},"0b62":function(t,e,a){"use strict";a("75f7")},1:function(t,e,a){t.exports=a("56d7")},1106:function(t,e,a){},"14ae":function(t,e,a){t.exports=a.p+"img/poster.fdff2e0c.png"},2:function(t,e){},2028:function(t,e,a){"use strict";a("4aae")},"29fc":function(t,e,a){"use strict";a("05b7")},3:function(t,e){},"36cf":function(t,e,a){"use strict";a("a5e6")},"38bd":function(t,e,a){},"3b3e":function(t,e,a){t.exports=a.p+"img/head.ab5d1f94.jpg"},"3fa0":function(t,e,a){"use strict";a("f2c4")},"4aae":function(t,e,a){},"4f17":function(t,e,a){"use strict";a("7484")},"56d7":function(t,e,a){"use strict";a.r(e);a("9f60"),a("94f0"),a("2843"),a("a450"),a("4057"),a("1bc78"),a("0c84"),a("3e38"),a("fc02"),a("25ba"),a("5f1c"),a("6ba0"),a("b47f");var r=a("f568"),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},i=[],n=(a("f093"),a("0b56")),o={},l=Object(n["a"])(o,s,i,!1,null,null,null),c=l.exports,u=a("f038"),h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home"},[e("img",{attrs:{alt:"Vue logo",src:a("cf05")}}),e("HelloWorld",{attrs:{msg:"Welcome to Your Vue.js App"}})],1)},p=[],d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"hello"},[e("h1",[t._v(t._s(t.msg))]),t._m(0),e("h3",[t._v("Installed CLI Plugins")]),t._m(1),e("h3",[t._v("Essential Links")]),t._m(2),e("h3",[t._v("Ecosystem")]),t._m(3)])},m=[function(){var t=this,e=t._self._c;return e("p",[t._v("\n    For a guide and recipes on how to configure / customize this project,"),e("br"),t._v("\n    check out the\n    "),e("a",{attrs:{href:"https://cli.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vue-cli documentation")]),t._v(".\n  ")])},function(){var t=this,e=t._self._c;return e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-babel",target:"_blank",rel:"noopener"}},[t._v("babel")])]),e("li",[e("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-eslint",target:"_blank",rel:"noopener"}},[t._v("eslint")])])])},function(){var t=this,e=t._self._c;return e("ul",[e("li",[e("a",{attrs:{href:"https://vuejs.org",target:"_blank",rel:"noopener"}},[t._v("Core Docs")])]),e("li",[e("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("Forum")])]),e("li",[e("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("Community Chat")])]),e("li",[e("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank",rel:"noopener"}},[t._v("Twitter")])]),e("li",[e("a",{attrs:{href:"https://news.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("News")])])])},function(){var t=this,e=t._self._c;return e("ul",[e("li",[e("a",{attrs:{href:"https://router.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vue-router")])]),e("li",[e("a",{attrs:{href:"https://vuex.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vuex")])]),e("li",[e("a",{attrs:{href:"https://github.com/vuejs/vue-devtools#vue-devtools",target:"_blank",rel:"noopener"}},[t._v("vue-devtools")])]),e("li",[e("a",{attrs:{href:"https://vue-loader.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vue-loader")])]),e("li",[e("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank",rel:"noopener"}},[t._v("awesome-vue")])])])}],f={name:"HelloWorld",props:{msg:String}},g=f,v=(a("36cf"),Object(n["a"])(g,d,m,!1,null,"b9167eee",null)),b=v.exports,C={name:"home",components:{HelloWorld:b}},y=C,A=Object(n["a"])(y,h,p,!1,null,null,null),w=A.exports,S=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("div",{staticClass:"enter-container"},[e("div",{staticClass:"logo"}),e("p",{staticClass:"slogan1"},[t._v("开始使用 财经眼 财务报表可视化在线工具")]),e("p",{staticClass:"slogan2"},[t._v("可视化显示财务报表，眨眼之间，图表呈现！可满足您对财务报表分析的直观需求！")]),e("router-link",{staticClass:"route",attrs:{to:"/HomePage"}},[e("button",{staticClass:"enter-button"},[t._v("开始使用")])])],1),t._m(0),e("div",{staticClass:"coin coin1",class:1===t.animationStatus?"coin1-animation":"",on:{animationend:t.nextAnimation}}),e("div",{staticClass:"coin coin2",class:2===t.animationStatus?"coin2-animation":"",on:{animationend:t.nextAnimation}}),e("div",{staticClass:"coin coin3",class:3===t.animationStatus?"coin3-animation":"",on:{animationend:t.nextAnimation}}),e("p",{staticClass:"copyright-font"},[t._v("©️ Fei Yang 2022")])])},x=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"poster"},[e("img",{staticClass:"img01",attrs:{src:a("14ae"),alt:"img"}})])}],F=function(){var t=this,e=t._self._c;return e("div",{staticClass:"loading-com"},[e("div",{staticClass:"circle circle1",style:{backgroundColor:t.background}}),e("div",{staticClass:"circle circle2",style:{backgroundColor:t.background}}),e("div",{staticClass:"circle circle3",style:{backgroundColor:t.background}})])},T=[],_={name:"loading-com",props:{background:String}},L=_,j=(a("3fa0"),Object(n["a"])(L,F,T,!1,null,"390c2de2",null)),O=j.exports,k={name:"login-page",components:{LoadingCom:O},data:function(){return{usernameStatus:1,usernameTip:"账号",passwordStatus:1,passwordTip:"密码",inputUsername:"",inputPassword:"",animationStatus:1,isLoading:!1}},methods:{enter:function(){},loginFunction:function(){var t=this,e=/^\w{6,15}$/;!this.isLoading&&e.test(this.inputUsername)?e.test(this.inputPassword)?(this.isLoading=!0,this.$axios.post("/login_view/",{username:this.inputUsername,password:this.inputPassword}).then((function(e){t.isLoading=!1})).catch((function(t){}))):(this.passwordStatus=0,this.passwordTip="请输入6-15位密码，匹配字母数字_"):(this.usernameStatus=0,this.usernameTip="请输入6-15位账号，匹配字母数字_")},nextAnimation:function(){this.animationStatus=this.animationStatus%3+1}}},P=k,D=(a("86c0"),Object(n["a"])(P,S,x,!1,null,"9a96beec",null)),M=D.exports,N=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("div",{staticClass:"left",style:{width:t.leftStyleObj.width+"%",display:t.leftStyleObj.display}},[e("side-bar-com",{attrs:{paramALArray:t.paramSheetsArray.ALArray,paramPFArray:t.paramSheetsArray.PFArray,paramCFArray:t.paramSheetsArray.CFArray},on:{"left-slide":t.leftSlide,"show-up-load":t.showUpLoad,"change-table":t.changeTable,"judge-tables-group":t.judgeTablesGroup}})],1),e("div",{staticClass:"middle"},[e("up-bar-com"),e("chart-container-com",{attrs:{"home-page-side":t.leftStyleObj.flag,"sheet-data":t.paramDataSets}})],1),e("div",{staticClass:"right"},[e("right-side-bar-com")],1),t.isShowUpLoad?e("up-load-sheet-com",{on:{"show-up-load":t.showUpLoad,"collect-data":t.collectData}}):t._e()],1)},I=[],G=(a("8dee"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"side-bar-com"},[e("div",{staticClass:"side-bar"},[e("button",{staticClass:"upload-btn",style:{opacity:t.sideBarOpacity?1:0},on:{click:t.showUpLoad}},[e("span",{staticClass:"upload-icon"}),e("span",[t._v("上传表格")])]),e("GeminiScrollbar",{staticClass:"scroll",style:{opacity:t.sideBarOpacity?1:0}},[e("div",{staticClass:"table-list-container"},[e("p",{staticClass:"table-list-title"},[e("span",{class:t.ALToggle?"down-triangle":"right-triangle",on:{click:t.ALHandle}}),e("span",{class:["ALGroup"===t.lastGroup?"selected-color":""],attrs:{"data-group":"ALGroup","data-index":"-1","data-title":"资产负债表汇总"},on:{click:t.changeTable}},[t._v("资产负债表")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.ALToggle,expression:"ALToggle"}],staticClass:"table-list"},t._l(t.ALArray,(function(a,r){return e("p",{class:[a.selected?"selected-color":""],attrs:{"data-title":a.title,"data-index":r,"data-group":a.group},on:{click:function(e){return t.changeTable(e)}}},[t._v("\n                            "+t._s(a.title)+"\n                        ")])})),0)]),e("div",{staticClass:"table-list-container"},[e("p",{staticClass:"table-list-title"},[e("span",{class:t.PFToggle?"down-triangle":"right-triangle",on:{click:t.PFHandle}}),e("span",{class:["PFGroup"===t.lastGroup?"selected-color":""],attrs:{"data-group":"PFGroup","data-index":"-1","data-title":"利润表（损益表）汇总"},on:{click:t.changeTable}},[t._v("利润表（损益表）")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.PFToggle,expression:"PFToggle"}],staticClass:"table-list"},t._l(t.PFArray,(function(a,r){return e("p",{class:[a.selected?"selected-color":""],attrs:{"data-title":a.title,"data-index":r,"data-group":a.group},on:{click:function(e){return t.changeTable(e)}}},[t._v("\n                            "+t._s(a.title)+"\n                        ")])})),0)]),e("div",{staticClass:"table-list-container"},[e("p",{staticClass:"table-list-title"},[e("span",{class:t.CFToggle?"down-triangle":"right-triangle",on:{click:t.CFHandle}}),e("span",{class:["CFGroup"===t.lastGroup?"selected-color":""],attrs:{"data-group":"CFGroup","data-index":"-1","data-title":"现金流量表汇总"},on:{click:t.changeTable}},[t._v("现金流量表")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.CFToggle,expression:"CFToggle"}],staticClass:"table-list"},t._l(t.CFArray,(function(a,r){return e("p",{class:[a.selected?"selected-color":""],attrs:{"data-title":a.title,"data-index":r,"data-group":a.group},on:{click:function(e){return t.changeTable(e)}}},[t._v("\n                            "+t._s(a.title)+"\n                        ")])})),0)])])],1),e("div",{staticClass:"toggle-container",style:{transform:"translate("+t.toggleObj.translateX+"%, -50%)"},on:{click:t.slide}},[e("div",{staticClass:"toggle-btn",class:[t.toggleObj.isPush?"toggle-push-btn":"toggle-pull-btn"]})]),e("div",{staticClass:"fill"})])}),B=[],$=a("a90c"),z=a.n($),H={name:"side-bar-com",props:{paramALArray:Array,paramPFArray:Array,paramCFArray:Array},data:function(){return{test:this.props,ALArray:this.paramALArray,ALToggle:!0,PFArray:this.paramPFArray,PFToggle:!0,CFArray:this.paramCFArray,CFToggle:!0,lastGroup:"ALGroup",lastIndex:null,sideBarOpacity:!0,toggleObj:{translateX:0,isPush:!0}}},methods:{changeTable:function(t){var e=t.target.getAttribute("data-title"),a=t.target.getAttribute("data-group"),s=parseInt(t.target.getAttribute("data-index")),i=this.lastGroup,n=this.lastIndex;if(null!==n&&-1!==n){var o=this[i][n];o.selected=!1,r["default"].set(this[i],n,o)}if(-1!==s){var l=this[a][s];l.selected=!0,r["default"].set(this[a],s,l)}this.lastIndex=s,this.lastGroup=a,this.$emit("change-table",e,a),this.$emit("judge-tables-group",s)},ALHandle:function(){this.ALToggle=!this.ALToggle},PFHandle:function(){this.PFToggle=!this.PFToggle},CFHandle:function(){this.CFToggle=!this.CFToggle},slide:function(){function t(){z.a.update()&&requestAnimationFrame(t)}this.sideBarOpacity=!this.sideBarOpacity,this.$emit("left-slide");var e=new z.a.Tween(this.toggleObj);!1===this.sideBarOpacity?e.to({translateX:30},100):e.to({translateX:0},100),e.start(),t(),this.toggleObj.isPush=!this.toggleObj.isPush},showUpLoad:function(){this.$emit("show-up-load")}}},E=H,W=(a("0b62"),Object(n["a"])(E,G,B,!1,null,"13354427",null)),U=W.exports,X=function(){var t=this,e=t._self._c;return e("div",{staticClass:"up-bar-com"},[e("div",{staticClass:"head-container"},[e("div",{staticClass:"information-container"},[e("img",{staticClass:"head-img",attrs:{src:a("3b3e")}}),e("span",{staticClass:"user-name"},[t._v(t._s(t.username))]),e("span",{staticClass:"down-triangle"})])])])},R=[],J={name:"up-bar-com",data:function(){return{username:"用户名"}}},q=J,V=(a("aae0"),Object(n["a"])(q,X,R,!1,null,"2e7b95e6",null)),Y=V.exports,Z=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"chart-container-com"}},[e("div",{staticClass:"head"},[e("p",{staticClass:"head-title"},[t._v(t._s(t.sheetData.title))]),e("div",{staticClass:"option-container"},[e("div",{staticClass:"option",on:{click:t.showCreateChart}},[e("span",{staticClass:"add-icon"}),e("span",[t._v("生成图表")])])])]),e("div",{staticClass:"chart-container",style:{height:t.chartContainerHeight+"px"},on:{click:t.checkChart}},[t._l(t.chartArray,(function(a,r){return e("div",{staticClass:"chart"},[e("button",{staticClass:"check-btn",attrs:{"data-btn-index":r}},[t._v("放大")]),e("chart-com",{attrs:{"resize-chart":t.resizeChart,"param-width":"100%","param-height":"100%","echart-option":a}})],1)})),e("div",{staticClass:"occupy-div"})],2),t.isShowCreateChart?e("create-chart-com",{attrs:{"sheet-data":t.sheetData},on:{"show-create-chart":t.showCreateChart}}):t._e(),t.isShowCheckChart?e("check-chart-com",{attrs:{"echart-option":t.echartOption},on:{"show-check-chart":t.showCheckChart}}):t._e()],1)},K=[],Q=function(){var t=this,e=t._self._c;return e("div",{staticClass:"create-chart-com"},[e("div",{staticClass:"create-chart-div"},[e("div",{staticClass:"head"},[e("button",{staticClass:"close-btn",on:{click:t.close}},[t._v("X")]),e("button",{staticClass:"confirm-btn",on:{click:t.confirmOption}},[t._v("确认生成")])]),e("div",{staticClass:"main"},[e("div",{staticClass:"left"},[e("option-com",{staticClass:"option-com",attrs:{"param-option-array":t.chartOptionArray},on:{"get-chart-option":t.getChartOption}}),e("chart-com",{staticClass:"chart-com",attrs:{"param-width":"620px","param-height":"450px","echart-option":t.echartOption}})],1),e("div",{staticClass:"right"},[e("div",{staticClass:"choose-subject"},[e("button",{class:[t.selectSubject?"selected-subject-btn":"unselected-subject-btn"],on:{click:t.chooseSubjects}},[t._v("选择科目\n                    ")]),"group"===t.sheetData.type?e("button",{class:[t.selectSubject?"unselected-subject-btn":"selected-subject-btn"],on:{click:t.chooseTables}},[t._v("筛选表格\n                    ")]):t._e()]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.selectSubject,expression:"selectSubject"}],staticClass:"subject-container"},[e("menu-com",{staticClass:"menu-com",attrs:{"param-choices-array":t.subjectArray,title:"可选科目"},on:{"get-subject":t.getData}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.selectSubject,expression:"!selectSubject"}],staticClass:"sheets-container",on:{click:t.sheetArrayChange}},t._l(t.sheetArray,(function(a,r){return e("div",{staticClass:"sheet-unit"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.selected,expression:"sheet.selected"}],attrs:{"data-sheet-name":a.sheetName,type:"checkbox",id:"sheet-unit-"+r},domProps:{checked:Array.isArray(a.selected)?t._i(a.selected,null)>-1:a.selected},on:{change:function(e){var r=a.selected,s=e.target,i=!!s.checked;if(Array.isArray(r)){var n=null,o=t._i(r,n);s.checked?o<0&&t.$set(a,"selected",r.concat([n])):o>-1&&t.$set(a,"selected",r.slice(0,o).concat(r.slice(o+1)))}else t.$set(a,"selected",i)}}}),e("label",{attrs:{for:"sheet-unit-"+r}},[e("span",[t._v(t._s(a.sheetName))])])])})),0)])])])])},tt=[],et=(a("00f2"),a("865b")),at=function(){var t=this,e=t._self._c;return e("div",{staticClass:"menu-com"},[e("button",{staticClass:"menu-btn",class:!0===t.menuBtnToggle?"menu-btn-on":"",on:{click:t.controlMenu}},[e("span",[t._v(t._s(t.title))]),e("span",{class:!0===t.menuBtnToggle?"triangle-down":"triangle-right"})]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.menuBtnToggle,expression:"menuBtnToggle"}],staticClass:"subjects-container",on:{click:t.getChoices}},t._l(t.choicesArray,(function(a,r){return e("button",{class:!0===a.selected?"selected-btn":"unselected-btn",attrs:{"data-index":r}},[t._v("\n            "+t._s(a.name)+"\n        ")])})),0)])},rt=[],st={name:"menu-com",props:{paramChoicesArray:Array,title:String},data:function(){return{menuBtnToggle:!0,choicesArray:this.paramChoicesArray,selectedMap:new Map}},watch:{paramChoicesArray:function(t,e){this.choicesArray=t}},methods:{controlMenu:function(){this.menuBtnToggle=!this.menuBtnToggle},getChoices:function(t){var e=t.target;if(null!==e.getAttribute("data-index")){var a=~~e.getAttribute("data-index");this.choicesArray[a].selected=!this.choicesArray[a].selected;var r=e.innerText;this.$emit("get-subject",r)}}},mounted:function(){}},it=st,nt=(a("7a9c"),Object(n["a"])(it,at,rt,!1,null,"2d1dc29a",null)),ot=nt.exports,lt=function(){var t=this,e=t._self._c;return e("div",{style:{width:t.paramWidth,height:t.paramHeight},attrs:{id:t.randomId}})},ct=[],ut={name:"chart-com",props:{paramWidth:"",paramHeight:"",echartOption:null,resizeChart:Boolean},data:function(){return{chart:null}},computed:{randomId:function(){return"chart-com"+Math.random().toString()}},methods:{draw:function(t){
//!ID重复问题！
var e=document.getElementById(this.randomId.toString()),a=this.$echarts.init(e,"Cat");a.clear(),a.setOption(t),this.chart=a},resize:function(){this.chart.resize()}},watch:{echartOption:function(t,e){this.draw(t)},resizeChart:function(t,e){this.resize()}},mounted:function(){null!==this.echartOption&&this.draw(this.echartOption)}},ht=ut,pt=Object(n["a"])(ht,lt,ct,!1,null,"9fd9e0d0",null),dt=pt.exports,mt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"option-com",on:{click:t.getChoices}},t._l(t.chartOptionArray,(function(a,r){return e("button",{staticClass:"option-btn",class:t.selectedIndex===r?"selected-option":"unselected-option",attrs:{"data-index":r}},[t._v(t._s(a))])})),0)},ft=[],gt={name:"option-com",props:{paramOptionArray:Array},data:function(){return{chartOptionArray:this.paramOptionArray,selectedIndex:0}},methods:{getChoices:function(t){var e=t.target;if(null!==e.getAttribute("data-index")){var a=~~e.getAttribute("data-index");if(a===this.selectedIndex)this.selectedIndex=-1,this.$emit("get-chart-option",null);else{this.selectedIndex=a;var r=e.innerText;this.$emit("get-chart-option",r)}}}}},vt=gt,bt=(a("29fc"),Object(n["a"])(vt,mt,ft,!1,null,"d06d43ba",null)),Ct=bt.exports;function yt(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=At(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,n=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){o=!0,i=t},f:function(){try{n||null==a.return||a.return()}finally{if(o)throw i}}}}function At(t,e){if(t){if("string"===typeof t)return wt(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?wt(t,e):void 0}}function wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}var St={name:"create-chart-com",components:{MenuCom:ot,ChartCom:dt,OptionCom:Ct},props:{sheetData:Object},data:function(){return{chartOptionArray:["柱形","饼状","折线+饼图","雷达图","正负轴"],chartOption:"柱形",subjectMap:new Map,echartOption:null,subjectArray:new Array,sheetArray:[],selectSubject:!0}},watch:{},methods:{getData:function(t){var e=this,a=new Map,r=null,s=null;if("table"===this.sheetData.type){var i=this.globalData.sheetsData[this.sheetData.group],n=i.get(this.sheetData.title);r=n.timeField1,s=n.timeField2;var o=this.getDataFromArray(t,n.dataSets,n.sheetTime);a.set(t,o);var l,c=yt(a);try{for(c.s();!(l=c.n()).done;){var u=Object(et["a"])(l.value,2),h=u[0],p=u[1];this.subjectMap.has(h)?this.subjectMap.delete(h):this.subjectMap.set(h,p)}}catch(v){c.e(v)}finally{c.f()}this.createEchartOption(this.chartOption,this.subjectMap,r,s)}else if("group"===this.sheetData.type){if(0===this.selectedArray.length)return this.subjectMap.has(t)?this.subjectMap.delete(t):this.subjectMap.set(t,[null,null,null,t]),void(this.echartOption=new Object);var d=this.getAllSubjectMap(this.subjectMap);d.has(t)?d.delete(t):d.set(t,!0);var m=this.globalData.sheetsData[this.sheetData.group.replace(/Group/,"Map")],f=this.getTimeFieldInGroup(m),g=Object(et["a"])(f,2);r=g[0],s=g[1],this.getTempSubjectMapInGroup(d,m).then((function(t){e.subjectMap=t,e.createEchartOption(e.chartOption,e.subjectMap,r,s)}))}},createEchartOption:function(t,e,a,r){var s=null;switch(t){case"柱形":s=i(e,a,r);break;case"饼状":s=n(e,a,r);break;case"折线+饼图":s=o(e,a,r);break;case"雷达图":s=l(e,a,r);break;case"正负轴":s=c(e,a,r);break}function i(t,e,a){var r,s=["timeField"],i=[{timeField:e},{timeField:a}],n=yt(t);try{for(n.s();!(r=n.n()).done;){var o=Object(et["a"])(r.value,2),l=o[0],c=o[1];s.push(l),i[0][l]=c[0],i[1][l]=c[1]}}catch(m){n.e(m)}finally{n.f()}for(var u=s.length-1,h=[],p=0;p<u;p++)h.push({type:"bar"});var d={legend:{},tooltip:{},dataset:{dimensions:s,source:i},series:h,xAxis:{type:"category"},yAxis:{},grid:{left:"15%"}};return d}function n(t,e,a){var r,s=[],i=[],n=yt(t);try{for(n.s();!(r=n.n()).done;){var o=Object(et["a"])(r.value,2),l=o[0],c=o[1];s.push({name:l,value:c[0]}),i.push({name:l,value:c[1]})}}catch(h){n.e(h)}finally{n.f()}var u={title:[{text:e,left:"25%",bottom:"15%"},{text:a,left:"73%",bottom:"15%"}],legend:{type:"scroll",top:30},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},series:[{name:e,type:"pie",roseType:"radius",radius:"40%",center:["30%","50%"],data:s,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:a,type:"pie",roseType:"radius",radius:"40%",center:["75%","50%"],data:i,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};return u}function o(t,e,a){var r={},s=[],i=[];s.push(["subject",e,a]);var n,o=yt(t);try{for(o.s();!(n=o.n()).done;){var l=Object(et["a"])(n.value,2),c=l[0],u=l[1];s.push([c,u[0],u[1]])}}catch(h){o.e(h)}finally{o.f()}return i=new Array(s.length-1).fill({type:"line",smooth:!0,seriesLayoutBy:"row"}),i.push({type:"pie",id:"pie",radius:"30%",center:["50%","25%"],label:{formatter:"{b}({d}%)"},encode:{itemName:"subject",value:e,tooltip:e}}),r={legend:{},tooltip:{trigger:"axis",showContent:!0},dataset:{source:s},title:{},xAxis:{type:"category"},yAxis:{gridIndex:0},grid:{top:"55%",left:"15%"},series:i},r}function l(t,e,a){var r,s={},i=new Map,n=-1,o=yt(t);try{for(o.s();!(r=o.n()).done;){var l=Object(et["a"])(r.value,2),c=l[0],u=l[1],h=u[0]>u[1]?u[0]:u[1];n=n>h?n:h,i.has(u[2]+"初")||(i.set(u[2]+"初",new Map),i.set(u[2]+"末",new Map));var p=i.get(u[2]+"初"),d=i.get(u[2]+"末");p.set(c,u[0]),d.set(c,u[1])}}catch(P){o.e(P)}finally{o.f()}var m={},f=[],g=[];m.indicator=[];var v,b=yt(t);try{for(b.s();!(v=b.n()).done;){var C=Object(et["a"])(v.value,2),y=C[0];C[1];m.indicator.push({text:y,max:n})}}catch(P){b.e(P)}finally{b.f()}var A,w=yt(i);try{for(w.s();!(A=w.n()).done;){var S=Object(et["a"])(A.value,2),x=S[0],F=S[1];g.push({type:"radar",symbol:"none",lineStyle:{width:1},emphasis:{areaStyle:{color:"rgba(0,250,0,0.3)"}},data:[{name:x,value:[]}]});var T,_=g[g.length-1],L=_.data[0].value,j=yt(F);try{for(j.s();!(T=j.n()).done;){var O=Object(et["a"])(T.value,2),k=(O[0],O[1]);L.push(k)}}catch(P){j.e(P)}finally{j.f()}f.push(x)}}catch(P){w.e(P)}finally{w.f()}return s={title:{},tooltip:{trigger:"item",backgroundColor:"rgba(0,0,250,0.2)"},visualMap:{top:"middle",right:10,max:n,min:0,color:["red","yellow"],calculable:!0},radar:m,legend:{type:"scroll",bottom:10,data:f},series:g},s}function c(t,e,a){var r,s=[],i=[],n=[],o=new Map,l=new Map,c=yt(t);try{for(c.s();!(r=c.n()).done;){var u=Object(et["a"])(r.value,2),h=(u[0],u[1]);o.has(h[3])||o.set(h[3],new Map),o.get(h[3]).set(h[2],h[1]-h[0]),!l.has(h[2])&&l.set(h[2],!0)}}catch(_){c.e(_)}finally{c.f()}var p,d=yt(l);try{for(d.s();!(p=d.n()).done;){var m=Object(et["a"])(p.value,2),f=m[0];m[1];i.push(f)}}catch(_){d.e(_)}finally{d.f()}var g,v=yt(o);try{for(v.s();!(g=v.n()).done;){var b=Object(et["a"])(g.value,2),C=b[0],y=b[1];n.push({name:C,type:"bar",label:{normal:{show:!0}},data:[]}),s.push(C);var A,w=n[n.length-1].data,S=yt(y);try{for(S.s();!(A=S.n()).done;){var x=Object(et["a"])(A.value,2),F=(x[0],x[1]);w.push(F)}}catch(_){S.e(_)}finally{S.f()}}}catch(_){v.e(_)}finally{v.f()}var T={title:{text:a+"-"+e},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:s},xAxis:[{type:"value"}],yAxis:[{type:"category",axisTick:{show:!1},data:i}],series:n};return T}this.echartOption=s},getGroupSubjectData:function(t,e,a){var r,s=[],i=new Map,n=yt(t);try{for(n.s();!(r=n.n()).done;){var o=r.value;!0===o.selected&&s.push(o.sheetName)}}catch(m){n.e(m)}finally{n.f()}for(var l=0,c=s;l<c.length;l++){var u=c[l],h=e.get(u),p=h.sheetTime,d=this.getDataFromArray(a,h.dataSets,h.sheetTime);i.set(p+a,d)}return i},sheetArrayChange:function(t){var e=this,a=t.target.getAttribute("data-sheet-name");if(null!==a&&void 0!==a){var r=this.subjectMap,s=this.globalData.sheetsData[this.sheetData.group.replace(/Group/,"Map")],i=(s.get(a).sheetTime,null),n=null,o=this.getAllSubjectMap(r),l=this.getTimeFieldInGroup(s),c=Object(et["a"])(l,2);i=c[0],n=c[1],this.getTempSubjectMapInGroup(o,s).then((function(t){e.subjectMap=t,0!==e.subjectMap.size&&e.createEchartOption(e.chartOption,e.subjectMap,i,n)}))}},getChartOption:function(t){if(this.chartOption=t,0!==this.subjectMap.size){var e=null,a=null;if("table"===this.sheetData.type){var r=this.globalData.sheetsData[this.sheetData.group],s=r.get(this.sheetData.title);e=s.timeField1,a=s.timeField2}else if("group"===this.sheetData.type){var i=this.globalData.sheetsData[this.sheetData.group.replace(/Group/,"Map")],n=this.getTimeFieldInGroup(i),o=Object(et["a"])(n,2);e=o[0],a=o[1]}this.createEchartOption(t,this.subjectMap,e,a)}},close:function(){this.$emit("show-create-chart")},getDataFromArray:function(t,e,a){var r,s=yt(e);try{for(s.s();!(r=s.n()).done;){var i=r.value;if(-1!==i.name.indexOf(t))return[i.value1,i.value2,a,t]}}catch(n){s.e(n)}finally{s.f()}return null},confirmOption:function(){var t=this.sheetData,e=this.echartOption;if(null!==e)if("table"===t.type){var a=this.globalData.sheetsData[t.group].get(t.title).charts;a.push(e)}else{var r=this.globalData.sheetsData[t.group];r.push(e)}this.$emit("show-create-chart")},chooseSubjects:function(){this.selectSubject=!0},chooseTables:function(){this.selectSubject=!1},getAllSubjectMap:function(t){var e,a=new Map,r=yt(t);try{for(r.s();!(e=r.n()).done;){var s=Object(et["a"])(e.value,2),i=(s[0],s[1]);a.has(i[3])||a.set(i[3],!0)}}catch(n){r.e(n)}finally{r.f()}return a},getTimeFieldInGroup:function(t){var e,a=null,r=null,s=yt(t);try{for(s.s();!(e=s.n()).done;){var i=Object(et["a"])(e.value,2),n=(i[0],i[1]);if(null===a){a=n.timeField1,r=n.timeField2;break}}}catch(o){s.e(o)}finally{s.f()}return[a,r]},getTempSubjectMapInGroup:function(t,e){var a=this,r=new Promise((function(r,s){setTimeout((function(){var s=new Map;if(0!==a.selectedArray.length){var i,n=yt(t);try{for(n.s();!(i=n.n()).done;){var o,l=Object(et["a"])(i.value,2),c=l[0],u=(l[1],yt(a.selectedArray));try{for(u.s();!(o=u.n()).done;){var h=o.value,p=e.get(h),d=a.getDataFromArray(c,p.dataSets,p.sheetTime);s.set(p.sheetTime+c,d)}}catch(b){u.e(b)}finally{u.f()}}}catch(b){n.e(b)}finally{n.f()}}else{var m,f=yt(t);try{for(f.s();!(m=f.n()).done;){var g=Object(et["a"])(m.value,2),v=g[0];g[1];s.set(v,[null,null,null,v])}}catch(b){f.e(b)}finally{f.f()}}r(s)}),0)}));return r},getTempSubjectMapByFun:function(t,e){var a,r=new Map,s=[],i=yt(this.sheetArray);try{for(i.s();!(a=i.n()).done;){var n=a.value;!0===n.selected&&s.push(n.sheetName)}}catch(g){i.e(g)}finally{i.f()}var o,l=yt(t);try{for(l.s();!(o=l.n()).done;){var c,u=Object(et["a"])(o.value,2),h=u[0],p=(u[1],yt(s));try{for(p.s();!(c=p.n()).done;){var d=c.value,m=e.get(d),f=this.getDataFromArray(h,m.dataSets,m.sheetTime);r.set(m.sheetTime+h,f)}}catch(g){p.e(g)}finally{p.f()}}}catch(g){l.e(g)}finally{l.f()}return r}},computed:{selectedArray:function(){var t,e=[],a=yt(this.sheetArray);try{for(a.s();!(t=a.n()).done;){var r=t.value;!0===r.selected&&e.push(r.sheetName)}}catch(s){a.e(s)}finally{a.f()}return e}},mounted:function(){var t=null,e=this.sheetData.group;if("group"===this.sheetData.type){var a=this.sheetData.group.replace(/Group/,"Map");e=this.sheetData.group.replace(/Group/,"Map");var r,s=this.globalData.sheetsData[a],i=yt(s);try{for(i.s();!(r=i.n()).done;){var n=Object(et["a"])(r.value,2),o=n[0],l=n[1];this.sheetArray.push({sheetName:o,selected:!1,sheetTime:l.sheetTime})}}catch(m){i.e(m)}finally{i.f()}}try{t=this.sheetArray[0].sheetName}catch(f){t=this.sheetData.title}var c,u=this.globalData.sheetsData[e].get(t),h=[],p=yt(u.dataSets);try{for(p.s();!(c=p.n()).done;){var d=c.value;null!==d.value1&&null!==d.value2&&"-"!==d.value1&&"-"!==d.value2&&h.push({name:d.name,selected:!1})}}catch(m){p.e(m)}finally{p.f()}this.subjectArray=h}},xt=St,Ft=(a("2028"),Object(n["a"])(xt,Q,tt,!1,null,"fd83347a",null)),Tt=Ft.exports,_t=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mask",on:{click:t.closeCheckChartCom}},[e("div",{staticClass:"chart-container"},[e("chart-com",{attrs:{"echart-option":t.echartOption,"param-width":"100%","param-height":"100%"}})],1)])},Lt=[],jt={name:"check-chart-com",components:{ChartCom:dt},props:{echartOption:Object},methods:{closeCheckChartCom:function(t){"CANVAS"!==t.target.tagName&&this.$emit("show-check-chart")}},mounted:function(){}},Ot=jt,kt=(a("4f17"),Object(n["a"])(Ot,_t,Lt,!1,null,"04aaa55e",null)),Pt=kt.exports,Dt={name:"chart-container-com",components:{CreateChartCom:Tt,ChartCom:dt,CheckChartCom:Pt},props:{sheetData:{title:"",type:"",group:""},homePageSide:Boolean},watch:{sheetData:function(t,e){var a=null;if("group"===t.type)a=this.globalData.sheetsData[t.group];else{var r=this.globalData.sheetsData[t.group].get(t.title);a=r.charts}this.chartArray=a},homePageSide:function(){this.resizeChart=!this.resizeChart}},data:function(){return{chartArray:[],isShowCreateChart:!1,chartContainerHeight:550,resizeChart:!1,canvasDom:null,echartOption:null,isShowCheckChart:!1}},methods:{checkChart:function(t){var e=t.target.getAttribute("data-btn-index"),a=null;if(null!==e&&void 0!==e){var r=parseInt(e);a="table"===this.sheetData.type?this.globalData.sheetsData[this.sheetData.group].get(this.sheetData.title).charts[r]:this.globalData.sheetsData[this.sheetData.group][r],this.echartOption=a,this.showCheckChart()}},showCreateChart:function(){this.isShowCreateChart=!this.isShowCreateChart},showCheckChart:function(){this.isShowCheckChart=!this.isShowCheckChart}},created:function(){var t=this;this.chartContainerHeight=window.innerHeight-190;var e=function(e){t.chartContainerHeight=window.innerHeight-190,t.resizeChart=!t.resizeChart};window.addEventListener("resize",e)}},Mt=Dt,Nt=(a("6a48"),Object(n["a"])(Mt,Z,K,!1,null,"7bde746b",null)),It=Nt.exports,Gt=function(){var t=this;t._self._c;return t._m(0)},Bt=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-side-bar-com"},[e("button",{staticClass:"top-button"}),e("button",{staticClass:"choice-btn chart-unselected-icon"}),e("button",{staticClass:"choice-btn trash-unselected-icon"}),e("button",{staticClass:"choice-btn help-unselected-icon"})])}],$t={name:"right-side-bar-com"},zt=$t,Ht=(a("ebbd"),Object(n["a"])(zt,Gt,Bt,!1,null,"3d2314d8",null)),Et=Ht.exports,Wt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("div",{directives:[{name:"show",rawName:"v-show",value:1===t.step,expression:"step === 1"}],staticClass:"up-load-div",on:{drop:t.handleDrop,dragover:function(t){t.preventDefault()}}},[e("p",{staticClass:"line drag-p"},[t._v("直接将文件拖拽到这里")]),e("p",{staticClass:"line or-p"},[t._v("或者")]),e("button",{staticClass:"choose-file-btn",on:{click:t.upLoad}},[t._v("选择文件")]),e("button",{staticClass:"close-btn",on:{click:t.close}},[t._v("X")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:2===t.step,expression:"step === 2"}],staticClass:"time-field-div"},[t._m(0),e("div",{staticClass:"field-input-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.customALSheetName,expression:"customALSheetName"}],staticClass:"input0",domProps:{value:t.customALSheetName},on:{input:function(e){e.target.composing||(t.customALSheetName=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ALTime[0],expression:"ALTime[0]"}],staticClass:"input1",domProps:{value:t.ALTime[0]},on:{input:function(e){e.target.composing||t.$set(t.ALTime,0,e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ALTime[1],expression:"ALTime[1]"}],staticClass:"input2",domProps:{value:t.ALTime[1]},on:{input:function(e){e.target.composing||t.$set(t.ALTime,1,e.target.value)}}})]),e("div",{staticClass:"field-input-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.customPFSheetName,expression:"customPFSheetName"}],staticClass:"input0",domProps:{value:t.customPFSheetName},on:{input:function(e){e.target.composing||(t.customPFSheetName=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.PFTime[0],expression:"PFTime[0]"}],staticClass:"input1",domProps:{value:t.PFTime[0]},on:{input:function(e){e.target.composing||t.$set(t.PFTime,0,e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.PFTime[1],expression:"PFTime[1]"}],staticClass:"input2",domProps:{value:t.PFTime[1]},on:{input:function(e){e.target.composing||t.$set(t.PFTime,1,e.target.value)}}})]),e("div",{staticClass:"field-input-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.customCFSheetName,expression:"customCFSheetName"}],staticClass:"input0",domProps:{value:t.customCFSheetName},on:{input:function(e){e.target.composing||(t.customCFSheetName=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.CFTime[0],expression:"CFTime[0]"}],staticClass:"input1",domProps:{value:t.CFTime[0]},on:{input:function(e){e.target.composing||t.$set(t.CFTime,0,e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.CFTime[1],expression:"CFTime[1]"}],staticClass:"input2",domProps:{value:t.CFTime[1]},on:{input:function(e){e.target.composing||t.$set(t.CFTime,1,e.target.value)}}})]),e("div",{staticClass:"field-input-container inline-block-div"},[t._m(1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.sheetTime,expression:"sheetTime"}],staticClass:"input1",domProps:{value:t.sheetTime},on:{input:function(e){e.target.composing||(t.sheetTime=e.target.value)}}}),e("button",{staticClass:"create-btn",on:{click:t.finishGetTime}},[t._v("完成")])]),e("button",{staticClass:"close-btn",on:{click:t.close}},[t._v("X")])])])},Ut=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"time-field-container"},[e("div",{staticClass:"div0"},[e("p",[t._v("表名")]),e("div",{staticClass:"down-triangle"})]),e("div",{staticClass:"div1"},[e("p",[t._v("填写时间字段一")]),e("div",{staticClass:"down-triangle"})]),e("div",{staticClass:"div2"},[e("p",[t._v("填写时间字段二")]),e("div",{staticClass:"down-triangle"})])])},function(){var t=this,e=t._self._c;return e("p",[e("span",[t._v("表时间")])])}],Xt=a("2396"),Rt=(a("b76b"),a("ce69")),Jt=a.n(Rt),qt={name:"up-load-sheet-com",data:function(){return{workbook:null,paramSheetsArray:[],sheetTime:"",ALSheetName:null,customALSheetName:"",ALDataTable:[],recordALPosArray1:[],recordALPosArray2:[],ALColumnsLength:null,ALRowsLength:null,ALDataSets:[],ALTime:[null,null],PFSheetName:null,customPFSheetName:"",PFDataTable:[],recordPFPosArray1:[],recordPFPosArray2:[],PFColumnsLength:null,PFRowsLength:null,PFDataSets:[],PFTime:[null,null],CFSheetName:null,customCFSheetName:"",CFDataTable:[],recordCFPosArray1:[],recordCFPosArray2:[],CFColumnsLength:null,CFRowsLength:null,CFDataSets:[],CFTime:[null,null],step:1}},methods:{upLoad:function(){var t=document.createElement("input");t.type="file",t.onchange=this.handleFiles,t.click()},finishGetTime:function(){var t=this.workbook,e=this.ALSheetName,a=this.PFSheetName,r=this.CFSheetName,s=Object(et["a"])(this.ALTime,2),i=s[0],n=s[1],o=Object(et["a"])(this.PFTime,2),l=o[0],c=o[1],u=Object(et["a"])(this.CFTime,2),h=u[0],p=u[1];try{this.parseALSheet(t,e,i,n)}catch(d){console.log(d)}try{this.parsePFSheet(t,a,l,c)}catch(d){console.log(d)}try{this.parseCFSheet(t,r,h,p)}catch(d){console.log(d)}this.$emit("collect-data",{name:this.sheetTime+this.customALSheetName,dataSets:this.ALDataSets,timeField1:i,timeField2:n,sheetTime:this.sheetTime},{name:this.sheetTime+this.customPFSheetName,dataSets:this.PFDataSets,timeField1:l,timeField2:c,sheetTime:this.sheetTime},{name:this.sheetTime+this.customCFSheetName,dataSets:this.CFDataSets,timeField1:h,timeField2:p,sheetTime:this.sheetTime}),this.close()},analysisFiles:function(t,e){var a=this,r=!1,s=null,i=null;"upload"===e?(s=t.target.files,i=s[0]):"drop"===e&&(s=t.dataTransfer.files,i=s[0]);var n=/^(.*)(\.)(\w*)$/,o=n.exec(i.name)[3].toLowerCase();if("xlsx"===o||"xls"===o){var l=new FileReader;l.onload=function(t){var e=t.target.result;!r&&(e=new Uint8Array(e));var s=Jt.a.read(e,{type:r?"binary":"array"});a.workbook=s,a.getSheetNames(s);for(var i=a.paramSheetsArray.length,n="资产负债",o="利润",l="现金",c=0;c<i;c++)"资产负债"!==n||-1===a.paramSheetsArray[c].indexOf(n)?"利润"!==o||-1===a.paramSheetsArray[c].indexOf(o)?"现金"!==l||-1===a.paramSheetsArray[c].indexOf(l)||(l=a.paramSheetsArray[c],a.CFSheetName=a.paramSheetsArray[c],a.customCFSheetName=a.paramSheetsArray[c]):(o=a.paramSheetsArray[c],a.PFSheetName=a.paramSheetsArray[c],a.customPFSheetName=a.paramSheetsArray[c]):(n=a.paramSheetsArray[c],a.ALSheetName=a.paramSheetsArray[c],a.customALSheetName=a.paramSheetsArray[c]);var u=a.workbook.Sheets[a.ALSheetName],h=a.workbook.Sheets[a.CFSheetName],p=a.workbook.Sheets[a.PFSheetName];function d(e){var a=new Map,r=null,s=null,i=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O"];for(var n in e){var o=/^([A-Z])(\d+)$/;try{var l=o.exec(n)[1],c=parseInt(o.exec(n)[2]);!a.has(l)&&a.set(l,{minIndex:c,maxIndex:c});var u=a.get(l);c<u.minIndex&&(u.minIndex=c),c>u.maxIndex&&(u.maxIndex=c)}catch(t){}}for(var h=0,p=i;h<p.length;h++){var d=p[h],m=a.get(d);if(void 0===m)break;for(var f=3,g=0,v=10,b=m.minIndex;g<=f&&b<=m.maxIndex;b++){var C=d+b.toString();if(e.hasOwnProperty(C)){var y=e[C].v;"number"===typeof y&&y>500&&g++,"number"===typeof y&&b<v&&(v=b)}}if(g>f)for(var A=v;A>0;A--)try{var w=e[d+A.toString()].v,S=Object(Xt["a"])(w);if("number"!==S&&"-"!==w){if(null===r){r=w;break}if(null===s){s=w;break}}}catch(t){}if(null!==r&&null!==s)break}return[r,s]}a.ALTime=d(u),a.PFTime=d(p),a.CFTime=d(h)},r?l.readAsBinaryString(i):l.readAsArrayBuffer(i)}else alert("请上传后缀为.xlsx的excel表格");this.step=2},handleFiles:function(t){this.analysisFiles(t,"upload")},handleDrop:function(t){t.stopPropagation(),t.preventDefault(),this.analysisFiles(t,"drop")},parseALSheet:function(t,e,a,r){var s=t.Sheets[e],i=this.getSheetSize(s),n=i.columnsLength,o=i.rowsLength;this.ALColumnsLength=n,this.ALRowsLength=o;var l=this.getDataTable(s,n,o,a,r),c=l.dataTable,u=l.recordPosArray1,h=l.recordPosArray2;this.ALDataTable=c,this.recordALPosArray1=u,this.recordALPosArray2=h,this.ALDataSets=this.getDataSets(u,h,c,n,o)},parsePFSheet:function(t,e,a,r){var s=t.Sheets[e],i=this.getSheetSize(s),n=i.columnsLength,o=i.rowsLength;this.PFColumnsLength=n,this.PFRowsLength=o;var l=this.getDataTable(s,n,o,a,r),c=l.dataTable,u=l.recordPosArray1,h=l.recordPosArray2;this.PFDataTable=c,this.recordPFPosArray1=u,this.recordPFPosArray2=h,this.PFDataSets=this.getDataSets(u,h,c,n,o)},parseCFSheet:function(t,e,a,r){var s=t.Sheets[e],i=this.getSheetSize(s),n=i.columnsLength,o=i.rowsLength;this.CFColumnsLength=n,this.CFRowsLength=o;var l=this.getDataTable(s,n,o,a,r),c=l.dataTable,u=l.recordPosArray1,h=l.recordPosArray2;this.CFDataTable=c,this.recordCFPosArray1=u,this.recordCFPosArray2=h,this.CFDataSets=this.getDataSets(u,h,c,n,o)},getDataSets:function(t,e,a,r,s){var i=[];if(t.length!==e.length)return alert("时间字段有误或漏填，请确认格式"),null;for(var n=t.length,o=0;o<n;o++){t[o].target;for(var l=t[o].row,c=this.letterToNum(t[o].column),u=l+1;u<=s;u++)if(null!==a[c][u]){a[c][u];var h=c;while(1)if(h--,"string"===typeof a[h][u]){var p={};p.name=a[h][u],p.value1=a[c][u],p.value2=a[c+1][u],i.push(p);break}}}return i},getSheetSize:function(t){var e=t["!ref"],a=/^(\w*):(\w*)$/,r=a.exec(e)[1],s=a.exec(e)[2],i=/^([A-Z]*)([0-9]*)$/,n=i.exec(r)[1],o=i.exec(r)[2],l=i.exec(s)[1],c=i.exec(s)[2],u=l.charCodeAt(0)-n.charCodeAt(0)+1,h=parseInt(c,10)-parseInt(o,10)+1;return{columnsLength:u,rowsLength:h}},getDataTable:function(t,e,a,r,s){for(var i=[],n=[],o=[],l=1;l<=e;l++)i[l]=new Array(a+1);for(var c=1;c<=e;c++)for(var u=String.fromCharCode(c+64),h=1;h<=a;h++){var p=h,d=u+p.toString();t.hasOwnProperty(d)?(i[c][h]=t[d].v,"string"===typeof t[d].v&&-1!==t[d].v.indexOf(r)&&n.push({target:d,column:u,row:h}),"string"===typeof t[d].v&&-1!==t[d].v.indexOf(s)&&o.push({target:d,column:u,row:h})):i[c][h]=null}return{dataTable:i,recordPosArray1:n,recordPosArray2:o}},getSheetNames:function(t){this.paramSheetsArray=t.SheetNames},letterToNum:function(t){return t.charCodeAt(0)-64},close:function(){this.$emit("show-up-load")}}},Vt=qt,Yt=(a("099e"),Object(n["a"])(Vt,Wt,Ut,!1,null,"3e10d65c",null)),Zt=Yt.exports,Kt={name:"home-page",components:{CreateChartCom:Tt,UpLoadSheetCom:Zt,ChartContainerCom:It,SideBarCom:U,UpBarCom:Y,RightSideBarCom:Et},data:function(){return{tableTitle:"2003年资产负债表",sheetsData:{ALMap:new Map,PFMap:new Map,CFMap:new Map,ALGroup:[],PFGroup:[],CFGroup:[]},paramSheetsArray:{ALArray:[],PFArray:[],CFArray:[]},paramDataSets:{title:"资产负债表汇总",type:"group",group:"ALGroup"},leftStyleObj:{width:16.5,display:"block",flag:!0},isShowUpLoad:!1,tablesOrGroup:!0}},methods:{leftSlide:function(){var t=this;function e(){z.a.update()&&requestAnimationFrame(e)}var a=new z.a.Tween(this.leftStyleObj);16.5===this.leftStyleObj.width?a.to({width:1},100):a.to({width:16.5},100),a.start(),e(),setTimeout((function(){t.leftStyleObj.flag=!t.leftStyleObj.flag}),100)},showUpLoad:function(){this.isShowUpLoad=!this.isShowUpLoad},changeTable:function(t,e){var a=/Group/;if(!0===a.test(e)){var r={title:t,type:"group",group:e};this.paramDataSets=r}else{var s={title:t,type:"table",group:e.replace(/Array/,"Map")};this.paramDataSets=s}},judgeTablesGroup:function(t){this.tablesOrGroup=-1!==t},collectData:function(t,e,a){var r=this.globalData;r.sheetsData.ALMap.set(t.name,{dataSets:t.dataSets,timeField1:t.timeField1,timeField2:t.timeField2,sheetTime:t.sheetTime,charts:[]}),r.sheetsData.PFMap.set(e.name,{dataSets:e.dataSets,timeField1:e.timeField1,timeField2:e.timeField2,sheetTime:e.sheetTime,charts:[]}),r.sheetsData.CFMap.set(a.name,{dataSets:a.dataSets,timeField1:a.timeField1,timeField2:a.timeField2,sheetTime:a.sheetTime,charts:[]}),this.dataToParaSheetsArray(t,"ALArray",this.paramSheetsArray),this.dataToParaSheetsArray(e,"PFArray",this.paramSheetsArray),this.dataToParaSheetsArray(a,"CFArray",this.paramSheetsArray)},showCreateChart:function(){this.isShowCreateChart=!this.isShowCreateChart},dataToParaSheetsArray:function(t,e,a){a[e].push({title:t.name,selected:!1,group:e})}}},Qt=Kt,te=(a("b0cf"),Object(n["a"])(Qt,N,I,!1,null,"b1857b7c",null)),ee=te.exports;r["default"].use(u["a"]);var ae=new u["a"]({mode:"hash",base:"",routes:[{path:"/",redirect:"/LoginPage"},{path:"/HomePage",name:"HomePage",component:ee},{path:"/LoginPage",name:"LoginPage",component:M},{path:"/home",name:"home",component:w},{path:"/about",name:"about",component:function(){return a.e("about").then(a.bind(null,"f820"))}}]}),re=a("f753"),se=a.n(re),ie=a("7a80"),ne=a.n(ie),oe=a("8e41"),le=a.n(oe),ce=(a("fcea"),a("4d28")),ue=a.n(ce),he=a("659b");function pe(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=de(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,n=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){o=!0,i=t},f:function(){try{n||null==a.return||a.return()}finally{if(o)throw i}}}}function de(t,e){if(t){if("string"===typeof t)return me(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?me(t,e):void 0}}function me(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function fe(t){var e,a=/^(\S+)=(\S+)$/,r=t.split("; "),s=new Map,i=pe(r);try{for(i.s();!(e=i.n()).done;){var n=e.value,o=a.exec(n);s.set(o[1],o[2])}}catch(l){i.e(l)}finally{i.f()}return s}function ge(t){return JSON.parse(JSON.stringify(t))}r["default"].config.productionTip=!1,r["default"].use(ne.a),r["default"].use(le.a);var ve=se.a.create({headers:{"Content-Type":"application/json"}});ve.interceptors.request.use((function(t){return t.headers["X-CSRFToken"]=fe(document.cookie).get("csrftoken"),t}),(function(t){return Promise.reject(t)})),ve.interceptors.response.use((function(t){return t}),(function(t){})),r["default"].prototype.globalFunction={},r["default"].prototype.globalFunction.getCookieMap=fe,r["default"].prototype.globalFunction.deepCopyByJSON=ge,r["default"].prototype.globalData={sheetsData:{ALMap:new Map,PFMap:new Map,CFMap:new Map,ALGroup:[],PFGroup:[],CFGroup:[]}},r["default"].prototype.$axios=ve,ue.a.registerTheme("Cat",he.theme),r["default"].prototype.$echarts=ue.a;var be=new r["default"]({router:ae,render:function(t){return t(c)}});be.$mount("#app")},"616c":function(t,e,a){},"659b":function(t){t.exports=JSON.parse('{"version":1,"themeName":"customed","theme":{"seriesCnt":3,"backgroundColor":"rgba(252,252,252,0)","titleColor":"#516b91","subtitleColor":"#b3b3b3","textColorShow":false,"textColor":"#333","markTextColor":"#eee","color":["#f6b73f","#3f4566","#a1c9f9","#a0a7e6","#c4ebad","#96dee8"],"borderColor":"#ccc","borderWidth":0,"visualMapColor":["#bf444c","#d88273","#f6efa6"],"legendTextColor":"#333","kColor":"#c23531","kColor0":"#314656","kBorderColor":"#c23531","kBorderColor0":"#314656","kBorderWidth":1,"lineWidth":2,"symbolSize":4,"symbol":"emptyCircle","symbolBorderWidth":1,"lineSmooth":false,"graphLineWidth":1,"graphLineColor":"#aaa","mapLabelColor":"#000","mapLabelColorE":"rgb(100,0,0)","mapBorderColor":"#444","mapBorderColorE":"#444","mapBorderWidth":0.5,"mapBorderWidthE":1,"mapAreaColor":"#eee","mapAreaColorE":"rgba(255,215,0,0.8)","axes":[{"type":"all","name":"通用坐标轴","axisLineShow":true,"axisLineColor":"#333","axisTickShow":true,"axisTickColor":"#333","axisLabelShow":true,"axisLabelColor":"#333","splitLineShow":true,"splitLineColor":["#ccc"],"splitAreaShow":false,"splitAreaColor":["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{"type":"category","name":"类目坐标轴","axisLineShow":true,"axisLineColor":"#333","axisTickShow":true,"axisTickColor":"#333","axisLabelShow":true,"axisLabelColor":"#333","splitLineShow":false,"splitLineColor":["#ccc"],"splitAreaShow":false,"splitAreaColor":["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{"type":"value","name":"数值坐标轴","axisLineShow":true,"axisLineColor":"#333","axisTickShow":true,"axisTickColor":"#333","axisLabelShow":true,"axisLabelColor":"#333","splitLineShow":true,"splitLineColor":["#ccc"],"splitAreaShow":false,"splitAreaColor":["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{"type":"log","name":"对数坐标轴","axisLineShow":true,"axisLineColor":"#333","axisTickShow":true,"axisTickColor":"#333","axisLabelShow":true,"axisLabelColor":"#333","splitLineShow":true,"splitLineColor":["#ccc"],"splitAreaShow":false,"splitAreaColor":["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{"type":"time","name":"时间坐标轴","axisLineShow":true,"axisLineColor":"#333","axisTickShow":true,"axisTickColor":"#333","axisLabelShow":true,"axisLabelColor":"#333","splitLineShow":true,"splitLineColor":["#ccc"],"splitAreaShow":false,"splitAreaColor":["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}],"axisSeperateSetting":true,"toolboxColor":"#999","toolboxEmpasisColor":"#666","tooltipAxisColor":"#ccc","tooltipAxisWidth":1,"timelineLineColor":"#293c55","timelineLineWidth":1,"timelineItemColor":"#293c55","timelineItemColorE":"#a9334c","timelineCheckColor":"#e43c59","timelineCheckBorderColor":"rgba(194,53,49, 0.5)","timelineItemBorderWidth":1,"timelineControlColor":"#293c55","timelineControlBorderColor":"#293c55","timelineControlBorderWidth":0.5,"timelineLabelColor":"#293c55","datazoomBackgroundColor":"rgba(47,69,84,0)","datazoomDataColor":"rgba(47,69,84,0.3)","datazoomFillColor":"rgba(167,183,204,0.4)","datazoomHandleColor":"#a7b7cc","datazoomHandleWidth":"100","datazoomLabelColor":"#333"}}')},"6a48":function(t,e,a){"use strict";a("1106")},7484:function(t,e,a){},"75f7":function(t,e,a){},"7a9c":function(t,e,a){"use strict";a("96b7")},"86c0":function(t,e,a){"use strict";a("e610")},"96b7":function(t,e,a){},a5e6:function(t,e,a){},aae0:function(t,e,a){"use strict";a("616c")},b0cf:function(t,e,a){"use strict";a("38bd")},cf05:function(t,e,a){t.exports=a.p+"img/logo.5b501ba8.png"},d731:function(t,e,a){},dc2d:function(t,e,a){},e610:function(t,e,a){},ebbd:function(t,e,a){"use strict";a("d731")},f093:function(t,e,a){"use strict";a("05a4")},f2c4:function(t,e,a){}});
//# sourceMappingURL=app.ab6c4846.js.map